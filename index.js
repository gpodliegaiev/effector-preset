const METHOD = `
/*
{{DATA}}
*/

export interface {{TYPE_NAME}} {}
export interface {{TYPE_NAME}}Done {}
export interface {{TYPE_NAME}}Fail {}

/** {{METHOD_DESCRIPTION}} */
export const {{METHOD_NAME}}Fx = createEffect<{{TYPE_NAME}}, {{TYPE_NAME}}Done, {{TYPE_NAME}}Fail>({
  async handler(params) {
    const result = await requestFx({
      method: "{{HTTP_METHOD}}",
      path: "{{HTTP_URL}}",
      body: params,
    });
    return result.body as {{TYPE_NAME}}Done;
  }
});
`;

module.exports = {
  importRequest: 'disabled',
  disableTypesGenerate: true,

  templateFileNameCode: ({ swaggerData, changeCase }) =>
    `${changeCase.paramCase(swaggerData.info.title)}.ts`,

  templateCodeBefore: ({ swaggerData }) =>
    [
      `// ${swaggerData.info.title} ${swaggerData.info.version}`,
      `// --- `,
      `// This file is automatically generated by swagger-to-js with preset @sergeysova/swagger-to-js-preset`,
      `// Do not edit this file directly. Instead open swagger-to-js config file and follow the link in "file"`,
      '',
      `import { createEffect } from 'effector-root';`,
      `import { requestFx } from './request';`,
      ``,
      '',
    ].join('\n'),

  templateRequestCode: (
    { name, method, url },
    { requestSwaggerData, changeCase },
  ) =>
    METHOD.trim()
      .replace(/{{METHOD_DESCRIPTION}}/g, requestSwaggerData.description)
      .replace(/{{METHOD_NAME}}/g, changeCase.camelCase(name))
      .replace(/{{TYPE_NAME}}/g, changeCase.pascalCase(name))
      .replace(/{{HTTP_METHOD}}/g, changeCase.constantCase(method))
      .replace(/{{HTTP_URL}}/g, url)
      .replace(/{{DATA}}/g, JSON.stringify(requestSwaggerData, null, 2)),
};
